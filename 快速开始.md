# æ³‰ç­–é€šæ™ºèƒ½ä½“ v2.0 - å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ¯ æ ¸å¿ƒå˜æ›´

### ä¹‹å‰ï¼ˆæ—§æ¶æ„ï¼‰
- 7ä¸ªç‹¬ç«‹æœåŠ¡ï¼Œ8001-8007ç«¯å£
- éœ€è¦è¿è¡Œ `./start.sh` å¯åŠ¨æ‰€æœ‰æœåŠ¡
- ç®€å•å…³é”®è¯åŒ¹é…æ„å›¾

### ç°åœ¨ï¼ˆæ–°æ¶æ„ï¼‰
- âœ… **1ä¸ªç»Ÿä¸€æœåŠ¡ï¼Œ8000ç«¯å£**
- âœ… **è¿è¡Œ `python app.py` å³å¯å¯åŠ¨**
- âœ… **å¤§æ¨¡å‹é©±åŠ¨çš„æ„å›¾è¯†åˆ«**
- âœ… **æ‰å¹³åŒ–JSONè¾“å‡º**

## ğŸ“¦ 30ç§’å¿«é€Ÿå¯åŠ¨

### Step 1: å®‰è£…ä¾èµ–
pip install fastapi uvicorn python-dotenv httpx pydantic requests


### Step 2: å¯åŠ¨æœåŠ¡
python app.py


### Step 3: æµ‹è¯•
python test_query.py "æµå—å¸‚å®¶ç”µè¡¥è´´æ”¿ç­–"


## ğŸ”¥ æ ¸å¿ƒæ¥å£

### ç»Ÿä¸€æŸ¥è¯¢æ¥å£
**URL:** `POST http://127.0.0.1:8000/query`

**ç¤ºä¾‹è¯·æ±‚:**
curl -X POST http://127.0.0.1:8000/query \
  -H "Content-Type: application/json" \
  -d '{"query": "åœ¨æµå—ä¹°äº†3000å…ƒçš„ç©ºè°ƒèƒ½é¢†å¤šå°‘è¡¥è´´ï¼Ÿ"}'


**ç¤ºä¾‹å“åº”:**
{
  "success": true,
  "intent": "personal_welfare",
  "entities": {
    "location": "æµå—",
    "product": "ç©ºè°ƒ",
    "industry": "appliance",
    "price_paid": 3000
  },
  "result": {
    "subsidy_amount": 600,
    "subsidy_breakdown": "åŸºç¡€è¡¥è´´15%: 450å…ƒ; ä»¥æ—§æ¢æ–°5%: 150å…ƒ",
    "total_benefit": 600
  },
  "final_answer": "æ‚¨åœ¨æµå—è´­ä¹°3000å…ƒçš„ç©ºè°ƒï¼Œå¯äº«å—600å…ƒè¡¥è´´..."
}


## ğŸ“ 4ç§æ„å›¾ç¤ºä¾‹

### 1. æ”¿ç­–è§£æ (policy_parse)
python test_query.py "æµå—å¸‚2025å¹´å®¶ç”µä»¥æ—§æ¢æ–°æ”¿ç­–æ˜¯ä»€ä¹ˆï¼Ÿ"


### 2. ç¦åˆ©è®¡ç®— (personal_welfare)
python test_query.py "åœ¨æµå—ä¹°äº†3000å…ƒçš„ç©ºè°ƒèƒ½é¢†å¤šå°‘è¡¥è´´ï¼Ÿ"


### 3. åŒºåŸŸå¯¹æ¯” (regional_compare)
python test_query.py "æµå—å’Œé’å²›çš„å®¶ç”µè¡¥è´´æ”¿ç­–å“ªä¸ªå¥½ï¼Ÿ"


### 4. ä¼ä¸šä¿¡å·ç¯ (investment_signal)
python test_query.py "å®¶ç”µè¡Œä¸šæœ‰å“ªäº›å€¼å¾—æ‹›å•†çš„ä¼ä¸šï¼Ÿ"


## ğŸ“‚ æ•°æ®æ–‡ä»¶ä½ç½®

æ‰€æœ‰æ•°æ®å·²æ•´ç†åˆ° `data/` ç›®å½•ï¼š

data/
â”œâ”€â”€ policies/              # æ”¿ç­–æ•°æ®
â”‚   â”œâ”€â”€ policies.jsonl     # ä¸»æ”¿ç­–åº“
â”‚   â”œâ”€â”€ å®¶ç”µè¡¥è´´æ”¿ç­–/       # è¡¥å……æ”¿ç­–
â”‚   â”œâ”€â”€ æ•°ç è¡¥è´´æ”¿ç­–/
â”‚   â”œâ”€â”€ æ±½è½¦è¡¥è´´æ”¿ç­–/
â”‚   â””â”€â”€ é›¶å”®é¤é¥®è¡¥è´´æ”¿ç­–/
â””â”€â”€ companies/             # ä¼ä¸šæ•°æ®
    â”œâ”€â”€ companies_appliance.jsonl
    â”œâ”€â”€ companies_digital.jsonl
    â”œâ”€â”€ companies_auto.jsonl
    â””â”€â”€ companies_retail.jsonl


## âš™ï¸ é…ç½®æ–‡ä»¶

`.env` æ–‡ä»¶ï¼ˆå¤§æ¨¡å‹é…ç½®ï¼‰ï¼š
DASHSCOPE_API_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
DASHSCOPE_API_KEY=your_api_key_here


## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

# å¯åŠ¨æœåŠ¡
python app.py

# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://127.0.0.1:8000/health

# æµ‹è¯•å•ä¸ªæŸ¥è¯¢
python test_query.py "ä½ çš„æŸ¥è¯¢å†…å®¹"

# è¿è¡Œå®Œæ•´æµ‹è¯•
python test_service.py

# æŸ¥çœ‹APIæ–‡æ¡£
# è®¿é—® http://127.0.0.1:8000/docs


## â“ å¸¸è§é—®é¢˜

### Q1: æœåŠ¡æ— æ³•å¯åŠ¨ï¼Ÿ
**A:** æ£€æŸ¥ç«¯å£8000æ˜¯å¦è¢«å ç”¨
netstat -ano | findstr :8000  # Windows
lsof -i :8000                # Linux/Mac


### Q2: æç¤ºAPI Keyé”™è¯¯ï¼Ÿ
**A:** æ£€æŸ¥ `.env` æ–‡ä»¶é…ç½®æ˜¯å¦æ­£ç¡®

### Q3: ä¸­æ–‡æ˜¾ç¤ºä¹±ç ï¼Ÿ
**A:** ç¡®ä¿æ•°æ®æ–‡ä»¶ä½¿ç”¨UTF-8ç¼–ç 

### Q4: æŸ¥è¯¢ç»“æœä¸ºç©ºï¼Ÿ
**A:** æ£€æŸ¥ `data/policies/policies.jsonl` æ–‡ä»¶æ˜¯å¦å­˜åœ¨

## ğŸ‰ å®Œæˆï¼

ç°åœ¨æ‚¨å·²ç»å¯ä»¥ä½¿ç”¨æ–°çš„æ³‰ç­–é€šæ™ºèƒ½ä½“æœåŠ¡äº†ï¼

**æœåŠ¡åœ°å€ï¼š** http://127.0.0.1:8000  
**APIæ–‡æ¡£ï¼š** http://127.0.0.1:8000/docs  
**å¥åº·æ£€æŸ¥ï¼š** http://127.0.0.1:8000/health

---

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒ `æ–°æ¶æ„è¯´æ˜.md` å’Œ `é‡æ„å®Œæˆè¯´æ˜.md`
